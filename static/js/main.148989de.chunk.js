(this["webpackJsonpauthzyin-example"]=this["webpackJsonpauthzyin-example"]||[]).push([[0],{64:function(e,t,n){e.exports=n(78)},78:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n(9),c=n(15),i=n(24),l=n(19),u=n(14),s=n(16),f=n(49),m=n(50),d=n(17),p=n.n(d),h=n(29),v="".concat(".","/policies.json"),E="".concat(".","/places.json"),b=function(){var e=Object(h.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(!(n=e.sent).ok){e.next=9;break}return e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 9:throw new Error(n.status.toString());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(h.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(E);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();!function(e){e.SetPlaces="SetPlaces",e.SetCurrentPlace="SetCurrentPlace",e.SetAlert="SetAlert"}(r||(r={}));var g,j,O=Object(s.a)(r.SetPlaces),w=Object(s.a)(r.SetCurrentPlace),C=Object(s.a)(r.SetAlert),x={getPlaces:function(){return function(){var e=Object(h.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:n=e.sent,t(O(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},setAlert:C,setCurrentPlace:w,enterPlace:function(e){return function(t){console.log('Entered "'.concat(e.name,'" successfully.')),t(w(e.id)),t(C({severity:j.Info,message:'You just walked into "'.concat(e.name,'"')}))}}},P=function(){return Object(s.c)(x)};!function(e){e.Info="info",e.Warn="warning",e.Error="error"}(j||(j={}));var S,T,A,k=Object(s.b)({places:[],currentPlace:-1},(g={},Object(i.a)(g,r.SetPlaces,[function(e,t){return Object(l.a)(Object(l.a)({},e),{},{places:t.payload,currentPlace:-1})}]),Object(i.a)(g,r.SetCurrentPlace,[function(e,t){return Object(l.a)(Object(l.a)({},e),{},{currentPlace:t.payload})}]),g)),q={severity:j.Info,message:"Which place do you want to go?"},I=Object(s.b)(q,Object(i.a)({},r.SetAlert,[function(e,t){return Object(l.a)(Object(l.a)({},e),t.payload)}])),R=Object(u.combineReducers)({places:k,alertInfo:I}),G=Object(u.createStore)(R,Object(f.composeWithDevTools)(Object(u.applyMiddleware)(m.a))),z=n(58),J=n(104),N=n(108),W=n(107),F=n(79),H=n(42);function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(e){return e.operator===S.Or}function Z(e){return(e.operator===S.Equals||e.operator===S.Contains||e.operator===S.GreaterThan||e.operator===S.GreaterThanOrEqualTo)&&void 0!==e.dataJPath}(A=S||(S={}))[A.Invalid=-100]="Invalid",A[A.RequiresRole=-1]="RequiresRole",A[A.Or=1]="Or",A[A.Equals=2]="Equals",A[A.GreaterThan=3]="GreaterThan",A[A.GreaterThanOrEqualTo=4]="GreaterThanOrEqualTo",A[A.Contains=5]="Contains",function(e){e[e.ContextToResource=1]="ContextToResource",e[e.ResourceToContext=2]="ResourceToContext"}(T||(T={}));var U,B=function e(t,n,r){var a=!1;return D(n)?a=function(t,n,r){for(var a=0;a<n.children.length;a++)if(e(t,n.children[a],r))return!0;return!1}(t,n,r):function(e){return e.operator===S.RequiresRole}(n)?a=function(e,t){for(var n=t.allowedRoles,r=e.userContext.roles,a=0;a<n.length;a++)if(r.indexOf(n[a])>=0)return!0;return!1}(t,n):Z(n)&&(a=function(e,t,n){var r;if(Z(r=t)&&void 0!==r.constValue&&(n={value:t.constValue}),!n)return!1;var a=Object(H.a)({path:t.dataJPath,json:e.data}),o=Object(H.a)({path:t.resourceJPath,json:n});return function(e,t,n){if(!e||!t||e.length<=0||t.length<=0)return!1;switch(n){case S.Equals:case S.GreaterThan:case S.GreaterThanOrEqualTo:return 1===e.length&&e.length===t.length&&(n===S.Equals&&e[0]===t[0]||n===S.GreaterThan&&e[0]>t[0]||n===S.GreaterThanOrEqualTo&&e[0]>=t[0]);case S.Contains:return 1===t.length&&e.some((function(e){return e===t[0]}));default:return!1}}(t.direction===T.ContextToResource?a:o,t.direction===T.ContextToResource?o:a,t.operator)}(t,n,r)),a},V=function(e){if(!e)return e;for(var t=e.length,n="",r=0;r<t;){var a=e.indexOf(".",r);n+=e.substr(r,(a=-1===a?t:a+1)-r),a<t&&"."!==e[a]&&(n+=e[a].toLowerCase(),a++),r=a}return n};function $(e){if(!e)throw new Error("AuthZyin React context is not setup. Call createAuthZyinContext first.")}var Y=function(){return $(void 0!==U),Object(a.useContext)(U)},K={url:"/authzyin/context",requestInitFn:function(){return Promise.resolve({})},jsonPathPropToCamelCase:!0},Q=function(e){var t=Object(a.useState)(),n=t[0],r=t[1],o=Y();return Object(a.useEffect)((function(){var t=L({},K,null==e?void 0:e.options),n=function(e){t.jsonPathPropToCamelCase&&function(e){e&&e.policies&&e.policies.forEach((function(e){var t;(t=e)&&t.requirements&&t.requirements.length>0&&t.requirements.forEach((function(e){return function e(t){D(t)&&t.children?t.children.forEach((function(t){return e(t)})):Z(t)&&(t.dataJPath=V(t.dataJPath),t.resourceJPath=V(t.resourceJPath))}(e)}))}))}(e),r(e)};o?n(o):function(){try{Promise.resolve(t.requestInitFn()).then((function(e){return e.method="GET",e.body=void 0,Promise.resolve(fetch(t.url,e)).then((function(e){return function(){if(e.ok)return Promise.resolve(e.json()).then((function(e){n(e)}));throw new Error("AuthZyinContext loading error: "+e.status)}()}))}))}catch(e){return Promise.reject(e)}}()}),[e]),$(void 0!==U),Object(a.createElement)(U.Provider,{value:n},n&&n.userContext&&e.children)},X=function(){var e=Y();return function(t,n){return function(e,t,n){if(!e||!e.userContext||!e.policies)return!1;var r=e.policies.filter((function(e){return e.name===t}))[0];if(!r||!r.requirements)return!1;for(var a,o=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return M(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}(r.requirements);!(a=o()).done;)if(!B(e,a.value,n))return!1;return!0}(e,t,n)}},_=function(e){var t=X();if(!(null==e?void 0:e.children))return Object(a.createElement)(a.Fragment,null);var n=t(e.policy,e.resource);return e.children(n)},ee=n(100),te=n(102),ne=n(103),re=n(51),ae=n.n(re),oe=function(e){var t=e.data;return a.createElement(ee.a,{variant:"outlined"},a.createElement(te.a,{title:"Client authorization context"}),a.createElement(ne.a,null,a.createElement(ae.a,{src:t,theme:"summerfruit",iconStyle:"triangle",collapsed:2,enableClipboard:!1})))},ce=n(36),ie=function(){var e=Y();return e?a.createElement(ee.a,{variant:"outlined"},a.createElement(te.a,{title:"User information"}),a.createElement(ne.a,null,a.createElement(ce.a,{variant:"body1",component:"div"},"Age: ",e.data.age),a.createElement(ce.a,{variant:"body1",component:"div"},"Has driver's license: ",String(e.data.withDriversLicense)),a.createElement(ce.a,{variant:"body1",component:"div"},"Has passport: ",String(e.data.withPassport)),a.createElement(ce.a,{variant:"body1",component:"div"},"PaymentMethods: ",JSON.stringify(e.data.paymentMethods.map((function(e){return e.type})))))):a.createElement(a.Fragment,null)},le=n(43),ue=function(e){return e.places},se=Object(le.a)([ue],(function(e){return e.places})),fe=(Object(le.a)([ue],(function(e){return e.currentPlace})),function(e){return e.alertInfo}),me=n(110),de=function(){var e=Object(c.c)(fe);return e.message?a.createElement(me.a,{severity:e.severity},e.message):a.createElement(a.Fragment,null)},pe=n(105);var he=n(4),ve=n(109),Ee=Object(he.a)((function(e){return{tooltip:{backgroundColor:e.palette.common.white,color:"rgba(0, 0, 0, 0.87)",boxShadow:e.shadows[1],fontSize:11}}}))(ve.a),be=n(56),ye=n.n(be),ge=n(57),je=n.n(ge),Oe=Object(J.a)((function(e){return{button:{margin:e.spacing(1)}}})),we=function(e,t){return a.createElement(a.Fragment,null,a.createElement(ce.a,{color:"inherit"},e.name),a.createElement(ce.a,{color:"secondary"},"accepts ".concat(e.acceptedPaymentMethods[0].toString())),a.createElement(ce.a,{color:"secondary"},function(e){return void 0!==e.maxAge}(e)&&"Age:".concat(e.minAge,"-").concat(e.maxAge)),a.createElement(ce.a,{color:t?"primary":"error"},t?"Authorized":"Not authorized"))},Ce=function(e){return function(e){return void 0!==e.hasHappyHour}(e)?a.createElement(ye.a,null):a.createElement(je.a,null)},xe=function(e){var t=X()(e.place.policy,e.place);return a.createElement(Ee,{key:e.place.id,placement:"top",arrow:!0,title:we(e.place,t)},a.createElement(pe.a,{variant:"contained",className:e.buttonClass,color:t?"primary":"secondary",startIcon:Ce(e.place),onClick:function(){return e.onEnterPlace(t)}},e.place.name))},Pe=function(e){return a.createElement(_,{policy:e.place.policy,resource:e.place},(function(t){return a.createElement(Ee,{key:e.place.id,placement:"top",arrow:!0,title:we(e.place,t)},a.createElement(pe.a,{variant:"contained",className:e.buttonClass,color:t?"primary":"secondary",startIcon:Ce(e.place),onClick:function(){return e.onEnterPlace(t)}},e.place.name))}))},Se=function(e){var t=e.place,n=Oe(),r=P(),o=r.setAlert,c=r.setCurrentPlace,i=r.enterPlace,l=function(e){c(-1),e?i(t):(console.error('Entering "'.concat(t.name,'": not authorized')),o({severity:j.Warn,message:'Authorization failed - "'.concat(t.name,'" forbidden by policy "').concat(t.policy,'"')}))};return t.id%2===0?a.createElement(xe,{place:t,onEnterPlace:l,buttonClass:n.button}):a.createElement(Pe,{place:t,onEnterPlace:l,buttonClass:n.button})},Te=Object(J.a)((function(){return{placelist:{display:"flex",flexDirection:"row",justifyContent:"space-between"}}})),Ae=function(){var e=Te(),t=Object(c.c)(se),n=P().getPlaces;if(a.useEffect((function(){n()}),[n]),t&&t.length>=0){var r=t.map((function(e){return a.createElement(Se,{key:e.id,place:e})}));return a.createElement(ee.a,{variant:"outlined"},a.createElement(te.a,{title:"Local places nearby you"}),a.createElement(ne.a,null,a.createElement(ce.a,{variant:"subtitle1",component:"div"},"Hover to see more details. Click to enter"),a.createElement("div",{className:e.placelist},r),a.createElement(de,null)))}return a.createElement(a.Fragment,null)},ke=n(106),qe=function(){var e=Y();return e?a.createElement("div",null,a.createElement(ce.a,{variant:"h2",component:"h2"},"Welcome ",e.userContext.userName,"!"),a.createElement(ke.a,{container:!0,direction:"column",justify:"center",alignItems:"stretch"},a.createElement(ke.a,{item:!0,xl:12},a.createElement(Ae,null)),a.createElement(ke.a,{item:!0,xl:12},a.createElement(ie,null)),a.createElement(ke.a,{item:!0,xl:12},a.createElement(oe,{data:e})))):a.createElement(a.Fragment,null)},Ie=Object(z.a)({palette:{type:"dark"}}),Re=Object(J.a)((function(){return{root:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}}));!function(e){if(U)throw new Error("AuthZyin React context is already initialized.");U=Object(a.createContext)(e)}();var Ge=function(){var e=Re();return a.createElement(Q,{options:{url:v}},a.createElement(W.a,null,a.createElement(N.a,{theme:Ie},a.createElement(F.a,{className:e.root},a.createElement(qe,null)))))},ze=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Je(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.render(a.createElement(c.a,{store:G},a.createElement(Ge,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");ze?function(e){fetch(e).then((function(t){var n=t.headers.get("content-type");404===t.status||n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Je(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):Je(e)}))}}()}},[[64,1,2]]]);
//# sourceMappingURL=main.148989de.chunk.js.map